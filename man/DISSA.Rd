% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/disaa.R
\name{DISSA}
\alias{DISSA}
\title{Differential Abundance Detection via Log-Normal Modeling under Varying Support (DISSA)}
\usage{
DISSA(
  phyloseq_obj,
  counts,
  covariates,
  formula,
  conf = 0.95,
  lambda = 0.5,
  zero_adj = FALSE,
  outlier_replace = FALSE,
  outlier_conf = 0.99,
  beta_bound = c(-10, 10),
  theta_bound = c(0.01, 10),
  eta_bound = c(-10, 10),
  max_iter = 50,
  tol = 1e-06
)
}
\arguments{
\item{phyloseq_obj}{A \code{phyloseq} object containing OTU table and sample metadata. If provided, \code{counts} and \code{covariates} will be extracted from this object.}

\item{counts}{A numeric matrix of raw count data (samples x taxa). Only required if \code{phyloseq_obj} is not provided.}

\item{covariates}{A data frame of sample-level covariates. Only required if \code{phyloseq_obj} is not provided.}

\item{formula}{A right-hand-sided formula specifying the covariates of interest (e.g., \code{~ Group + Age}).}

\item{conf}{Confidence level for identifying significant taxa (default = 0.95).}

\item{lambda}{Regularization strength for penalizing the inverse squared overdispersion (default = 0.5).}

\item{zero_adj}{Logical; if \code{TRUE}, adjusts for the sample-wise zero proportion in the model (default = \code{FALSE}).}

\item{outlier_replace}{Logical; if \code{TRUE}, performs outlier replacement based on deviance residuals and Cookâ€™s distance (default = \code{FALSE}).}

\item{outlier_conf}{Confidence level used in outlier detection (default = 0.99).}

\item{beta_bound}{Bounds for coefficients (default = \code{c(-10, 10)}).}

\item{theta_bound}{Bounds for overdispersion parameters (default = \code{c(1e-2, 10)}).}

\item{eta_bound}{Bounds for log-scaling factors (default = \code{c(-10, 10)}).}

\item{max_iter}{Maximum number of iterations for the EM algorithm (default = 50).}

\item{tol}{Convergence tolerance for EM optimization (default = 1e-6).}
}
\value{
A list containing:
\describe{
\item{pi}{Estimated dropout probabilities for each taxon.}
\item{theta}{Estimated overdispersion parameters.}
\item{eta}{Estimated sample-specific log-scaling factors.}
\item{beta}{Coefficient matrix for covariate effects.}
\item{mu}{Estimated expected counts under the model.}
\item{pvalues}{Adjusted p-values for all covariates.}
\item{significant}{Logical matrix indicating significance under FDR or Bonferroni correction.}
\item{multiple_pvalues}{(Optional) Multi-group global and pairwise p-values for multi-class covariates.}
\item{multiple_significant}{(Optional) Significance matrix for multi-group tests.}
}
}
\description{
Performs differential abundance analysis using a zero-inflated negative binomial model with log-normal structure.
This function supports covariate adjustment, outlier replacement, and multiple testing correction for both binary and multi-class covariates.
}
