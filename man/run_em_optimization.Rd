% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_em_optimization.R
\name{run_em_optimization}
\alias{run_em_optimization}
\title{Run EM Optimization for Zero-Inflated Negative Binomial Model}
\usage{
run_em_optimization(
  data,
  X,
  eta,
  v,
  tau,
  beta,
  theta,
  pi,
  mu,
  lambda,
  beta_bound,
  theta_bound,
  eta_bound,
  update_index = NULL,
  max_iter,
  tol
)
}
\arguments{
\item{data}{A matrix of observed count data (samples × taxa).}

\item{X}{A design matrix of sample-level covariates (samples × covariates).}

\item{eta}{A numeric vector of sample-level intercepts.}

\item{v}{A binary matrix indicating observed non-zero support (samples × taxa).}

\item{tau}{A numeric matrix of latent dropout probabilities (samples × taxa).}

\item{beta}{A matrix of taxa-level covariate effects (taxa × covariates).}

\item{theta}{A numeric vector of dispersion parameters (length = number of taxa).}

\item{pi}{A numeric vector of zero-inflation probabilities (length = number of taxa).}

\item{mu}{A matrix of mean parameters (samples × taxa).}

\item{lambda}{Regularization penalty for dispersion parameters.}

\item{beta_bound}{A numeric vector of lower and upper bounds for beta coefficients (length 2).}

\item{theta_bound}{A numeric vector of lower and upper bounds for theta (length 2).}

\item{eta_bound}{A numeric vector of lower and upper bounds for eta (length 2).}

\item{update_index}{Optional integer vector indicating which taxa to update (default: all taxa).}

\item{max_iter}{Maximum number of EM iterations.}

\item{tol}{Tolerance for convergence of the likelihood.}
}
\value{
A list with the following elements:
\describe{
\item{beta}{Estimated beta coefficients (taxa × covariates).}
\item{theta}{Estimated dispersion parameters for each taxon.}
\item{pi}{Estimated zero-inflation probabilities.}
\item{eta}{Updated intercept vector.}
\item{tau}{Updated dropout probability matrix.}
\item{mu}{Estimated mean matrix.}
}
}
\description{
This function performs an Expectation-Maximization (EM) optimization for a
zero-inflated negative binomial (ZINB) model with sample-level and taxa-level covariates.
}
